# CirAni æ¶æ„é‡æ„å®æ–½æ¸…å•

## ä½¿ç”¨è¯´æ˜

æœ¬æ¸…å•åˆ—å‡ºäº†æ‰€æœ‰éœ€è¦åˆ›å»º/ä¿®æ”¹çš„æ–‡ä»¶,ä»¥åŠæ¯ä¸ªæ–‡ä»¶çš„å®ç°è¦ç‚¹ã€‚

âœ… = å·²å®Œæˆ
ğŸ”² = å¾…å®ç°
ğŸ“ = éœ€è¦å¡«å†™å†…å®¹

---

## ç¬¬ä¸€é˜¶æ®µ: åŸºç¡€æ¡†æ¶æ­å»º

### 1.1 ç›®å½•ç»“æ„ âœ…

å·²åˆ›å»ºä»¥ä¸‹ç›®å½•:
```
âœ… packages/CirAni/components/{basic,semiconductor,integrated}/
âœ… packages/CirAni/{animation,circuit,graphics,common}/
âœ… packages/CirAni/raylib/
âœ… packages/CirAni/include/
âœ… application/demos/{basic_circuit,rc_circuit,rlc_circuit}/
âœ… application/tutorials/lesson01/
âœ… target/{desktop_linux,desktop_windows,desktop_macos,configs}/
âœ… tools/env/{scons,kconfig}/
âœ… tools/scripts/
âœ… bsp/desktop/
âœ… patches/raylib/
âœ… output/{bin,lib}/
```

### 1.2 æ ¸å¿ƒæ„å»ºæ–‡ä»¶

#### ğŸ“ SConstruct (ä¸»æ„å»ºè„šæœ¬)
**ä½ç½®**: `/home/zane/project/raylib_pro/CirAni/SConstruct`
**çŠ¶æ€**: ğŸ”² éœ€è¦é‡å†™
**å‚è€ƒ**: `doc/design/D12xæ¶æ„å‚è€ƒæ‰‹å†Œ.md` ç¬¬äºŒç« 

**TODO æ¸…å•**:
- [ ] å¯¼å…¥ `tools/scripts/cirani_build.py`
- [ ] è¯»å–é¡¹ç›®é…ç½® (PRJ_TARGET, PRJ_APP)
- [ ] åˆ›å»ºç¼–è¯‘ç¯å¢ƒ (gcc, raylib)
- [ ] è°ƒç”¨ SConscript
- [ ] ç”Ÿæˆæœ€ç»ˆç¨‹åº

---

#### ğŸ“ SConscript (æ ¹SConscript)
**ä½ç½®**: `/home/zane/project/raylib_pro/CirAni/SConscript`
**çŠ¶æ€**: ğŸ”² éœ€è¦é‡å†™
**å‚è€ƒ**: `doc/design/D12xæ¶æ„å‚è€ƒæ‰‹å†Œ.md` ç¬¬ä¸‰ç« 

**TODO æ¸…å•**:
- [ ] Import å˜é‡ (CIRANI_ROOT, PRJ_TARGET, PRJ_APP)
- [ ] è°ƒç”¨ packages/SConscript
- [ ] è°ƒç”¨ bsp/SConscript (å¯é€‰)
- [ ] è°ƒç”¨ target/SConscript
- [ ] è°ƒç”¨ application/SConscript
- [ ] Return objs

---

#### ğŸ“ Kconfig (æ ¹é…ç½®æ–‡ä»¶)
**ä½ç½®**: `/home/zane/project/raylib_pro/CirAni/Kconfig`
**çŠ¶æ€**: ğŸ”² éœ€è¦é‡å†™
**å‚è€ƒ**: `doc/design/D12xæ¶æ„å‚è€ƒæ‰‹å†Œ.md` ç¬¬ä¸ƒç« 

**TODO æ¸…å•**:
- [ ] å®šä¹‰ PRJ_TARGET é€‰é¡¹
- [ ] å®šä¹‰ PRJ_APP é€‰é¡¹
- [ ] source packages/Kconfig
- [ ] source application/Kconfig
- [ ] source target/Kconfig

---

### 1.3 tools/scripts/ å·¥å…·è„šæœ¬

#### ğŸ“ cirani_build.py (æ ¸å¿ƒæ„å»ºå·¥å…·)
**ä½ç½®**: `/home/zane/project/raylib_pro/CirAni/tools/scripts/cirani_build.py`
**çŠ¶æ€**: ğŸ”² éœ€è¦åˆ›å»º
**å‚è€ƒ**: `doc/design/D12xæ¶æ„å‚è€ƒæ‰‹å†Œ.md` ç¬¬å…«ç« 

**TODO æ¸…å•**:
- [ ] å®ç° pr_err(), pr_info(), pr_warn()
- [ ] å®ç° chk_prj_config(root)
- [ ] å®ç° get_prj_config(root)
- [ ] å®ç°é…ç½®æ–‡ä»¶è§£æ

---

## ç¬¬äºŒé˜¶æ®µ: packages æ¨¡å—

### 2.1 packages/SConscript
**ä½ç½®**: `/home/zane/project/raylib_pro/CirAni/packages/SConscript`
**çŠ¶æ€**: ğŸ”² éœ€è¦åˆ›å»º
**å‚è€ƒ**: `doc/design/D12xæ¶æ„å‚è€ƒæ‰‹å†Œ.md` ç¬¬å››ç« 

**TODO æ¸…å•**:
- [ ] è°ƒç”¨ CirAni/SConscript
- [ ] è°ƒç”¨ third-party/SConscript (å¦‚æœ‰)

---

### 2.2 packages/CirAni/SConscript
**ä½ç½®**: `/home/zane/project/raylib_pro/CirAni/packages/CirAni/SConscript`
**çŠ¶æ€**: ğŸ”² éœ€è¦åˆ›å»º
**å‚è€ƒ**: `doc/design/D12xæ¶æ„å‚è€ƒæ‰‹å†Œ.md` ç¬¬äº”ç« 

**TODO æ¸…å•**:
- [ ] è°ƒç”¨ raylib/SConscript
- [ ] è°ƒç”¨ common/SConscript
- [ ] è°ƒç”¨ graphics/SConscript
- [ ] è°ƒç”¨ animation/SConscript
- [ ] è°ƒç”¨ circuit/SConscript
- [ ] è°ƒç”¨ components/SConscript

---

### 2.3 packages/CirAni/raylib/SConscript
**ä½ç½®**: `/home/zane/project/raylib_pro/CirAni/packages/CirAni/raylib/SConscript`
**çŠ¶æ€**: ğŸ”² éœ€è¦åˆ›å»º
**å‚è€ƒ**: `doc/design/D12xæ¶æ„å‚è€ƒæ‰‹å†Œ.md` ç¬¬ä¹ç« 

**å®ç°æ–¹æ¡ˆ** (ä¸‰é€‰ä¸€):
- [ ] æ–¹æ¡ˆ1: é“¾æ¥ç³»ç»Ÿ raylib (`-lraylib`)
- [ ] æ–¹æ¡ˆ2: è½¯é“¾æ¥åˆ° `/home/zane/src/raylib`
- [ ] æ–¹æ¡ˆ3: ç¼–è¯‘ raylib æºç 

---

### 2.4 packages/CirAni å­æ¨¡å— SConscript

#### packages/CirAni/common/SConscript
**çŠ¶æ€**: ğŸ“ ç©ºæ–‡ä»¶å·²åˆ›å»º
**TODO**: ç¼–è¯‘ `src/*.c`, è®¾ç½®å¤´æ–‡ä»¶è·¯å¾„

#### packages/CirAni/graphics/SConscript
**çŠ¶æ€**: ğŸ“ ç©ºæ–‡ä»¶å·²åˆ›å»º
**TODO**: ç¼–è¯‘ `src/*.c`, ä¾èµ– raylib

#### packages/CirAni/animation/SConscript
**çŠ¶æ€**: ğŸ“ ç©ºæ–‡ä»¶å·²åˆ›å»º
**TODO**: ç¼–è¯‘ `src/*.c`

#### packages/CirAni/circuit/SConscript
**çŠ¶æ€**: ğŸ“ ç©ºæ–‡ä»¶å·²åˆ›å»º
**TODO**: ç¼–è¯‘ `src/*.c`

#### packages/CirAni/components/SConscript
**çŠ¶æ€**: ğŸ”² éœ€è¦åˆ›å»º
**TODO**: éå† basic/, semiconductor/, integrated/

---

### 2.5 packages/CirAni/Kconfig
**ä½ç½®**: `/home/zane/project/raylib_pro/CirAni/packages/CirAni/Kconfig`
**çŠ¶æ€**: ğŸ“ ç©ºæ–‡ä»¶å·²åˆ›å»º
**TODO**:
- [ ] å®šä¹‰ CirAni æ¨¡å—å¼€å…³
- [ ] å®šä¹‰å…ƒä»¶é€‰æ‹©é€‰é¡¹

---

### 2.6 packages/Kconfig
**ä½ç½®**: `/home/zane/project/raylib_pro/CirAni/packages/Kconfig`
**çŠ¶æ€**: ğŸ”² éœ€è¦åˆ›å»º
**TODO**:
```kconfig
menu "Packages Configuration"
source "packages/CirAni/Kconfig"
endmenu
```

---

## ç¬¬ä¸‰é˜¶æ®µ: application æ¨¡å—

### 3.1 application/demos/basic_circuit/SConscript
**ä½ç½®**: `/home/zane/project/raylib_pro/CirAni/application/demos/basic_circuit/SConscript`
**çŠ¶æ€**: ğŸ”² éœ€è¦åˆ›å»º
**TODO**:
- [ ] ç¼–è¯‘ main.c
- [ ] æ·»åŠ å¤´æ–‡ä»¶è·¯å¾„

### 3.2 application/demos/basic_circuit/main.c
**ä½ç½®**: `/home/zane/project/raylib_pro/CirAni/application/demos/basic_circuit/main.c`
**çŠ¶æ€**: ğŸ”² éœ€è¦è¿ç§»
**TODO**:
- [ ] å°†ç°æœ‰ `application/src/main.c` è¿ç§»åˆ°è¿™é‡Œ
- [ ] æˆ–é‡å†™,è°ƒç”¨ CirAni API

### 3.3 application/Kconfig
**ä½ç½®**: `/home/zane/project/raylib_pro/CirAni/application/Kconfig`
**çŠ¶æ€**: ğŸ“ ç©ºæ–‡ä»¶å·²åˆ›å»º
**TODO**:
- [ ] å®šä¹‰åº”ç”¨é€‰æ‹©é€‰é¡¹

---

## ç¬¬å››é˜¶æ®µ: target é…ç½®

### 4.1 target/desktop_linux/defconfig
**ä½ç½®**: `/home/zane/project/raylib_pro/CirAni/target/desktop_linux/defconfig`
**çŠ¶æ€**: ğŸ”² éœ€è¦åˆ›å»º
**å†…å®¹ç¤ºä¾‹**:
```
CONFIG_PRJ_TARGET="desktop_linux"
CONFIG_PRJ_APP="basic_circuit"
```

### 4.2 target/Kconfig
**ä½ç½®**: `/home/zane/project/raylib_pro/CirAni/target/Kconfig`
**çŠ¶æ€**: ğŸ“ ç©ºæ–‡ä»¶å·²åˆ›å»º
**TODO**:
- [ ] å®šä¹‰ç›®æ ‡å¹³å°ç›¸å…³é…ç½®

---

## ç¬¬äº”é˜¶æ®µ: ä»£ç è¿ç§»

### 5.1 æ‹†åˆ†ç°æœ‰ main.c

**åŸæ–‡ä»¶**: `application/src/main.c` (108è¡Œ)

**æ‹†åˆ†æ–¹æ¡ˆ**:
- [ ] `packages/CirAni/common/` - æ•°æ®ç»“æ„(Electron)
- [ ] `packages/CirAni/animation/` - åŠ¨ç”»é€»è¾‘
- [ ] `packages/CirAni/graphics/` - æ¸²æŸ“é€»è¾‘
- [ ] `packages/CirAni/components/basic/wire/` - å¯¼çº¿
- [ ] `packages/CirAni/components/basic/battery/` - ç”µæ± 
- [ ] `packages/CirAni/components/basic/resistor/` - ç”µé˜»
- [ ] `application/demos/basic_circuit/main.c` - ä¸»ç¨‹åº

---

## ç¬¬å…­é˜¶æ®µ: æµ‹è¯•éªŒè¯

### 6.1 æœ€å°ç¼–è¯‘æµ‹è¯•
- [ ] ç¼–è¯‘é€šè¿‡: `scons`
- [ ] ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶: `output/bin/CirAni`

### 6.2 åŠŸèƒ½æµ‹è¯•
- [ ] ç¨‹åºæ­£å¸¸è¿è¡Œ
- [ ] åŠ¨ç”»æ•ˆæœæ­£å¸¸
- [ ] æ— å†…å­˜æ³„æ¼

### 6.3 æ„å»ºè„šæœ¬æµ‹è¯•
- [ ] `./tools/onestep.sh` å¯ç”¨
- [ ] `./build.sh` å¯ç”¨
- [ ] `scons -c` æ¸…ç†æ­£å¸¸

---

## æ–‡ä»¶æ¸…å•æ±‡æ€»

### éœ€è¦åˆ›å»ºçš„æ–‡ä»¶ (ğŸ”²)
```
ğŸ”² packages/SConscript
ğŸ”² packages/Kconfig
ğŸ”² packages/CirAni/SConscript
ğŸ”² packages/CirAni/components/SConscript
ğŸ”² application/demos/basic_circuit/SConscript
ğŸ”² application/demos/basic_circuit/main.c
ğŸ”² target/desktop_linux/defconfig
ğŸ”² tools/scripts/cirani_build.py
```

### éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶ (ğŸ“)
```
ğŸ“ SConstruct (é‡å†™)
ğŸ“ SConscript (é‡å†™)
ğŸ“ Kconfig (é‡å†™)
ğŸ“ packages/CirAni/raylib/SConscript
ğŸ“ packages/CirAni/common/SConscript
ğŸ“ packages/CirAni/graphics/SConscript
ğŸ“ packages/CirAni/animation/SConscript
ğŸ“ packages/CirAni/circuit/SConscript
ğŸ“ packages/CirAni/Kconfig
ğŸ“ application/Kconfig
ğŸ“ target/Kconfig
```

### å·²åˆ›å»ºçš„ç©ºæ–‡ä»¶ (âœ…)
```
âœ… packages/CirAni/animation/SConscript
âœ… packages/CirAni/circuit/SConscript
âœ… packages/CirAni/graphics/SConscript
âœ… packages/CirAni/common/SConscript
âœ… packages/CirAni/raylib/SConscript
âœ… packages/CirAni/Kconfig
âœ… application/Kconfig
âœ… target/Kconfig
```

---

## æ¨èå®æ–½é¡ºåº

1. **ç¬¬ä¸€æ­¥**: å®Œæˆ `tools/scripts/cirani_build.py`
2. **ç¬¬äºŒæ­¥**: ä¿®æ”¹ `SConstruct` å’Œ `SConscript`
3. **ç¬¬ä¸‰æ­¥**: å®ç° `packages/CirAni/raylib/SConscript`
4. **ç¬¬å››æ­¥**: åˆ›å»ºæœ€ç®€å•çš„ `application` å¹¶æµ‹è¯•ç¼–è¯‘
5. **ç¬¬äº”æ­¥**: é€æ­¥æ·»åŠ å…¶ä»–æ¨¡å—
6. **ç¬¬å…­æ­¥**: å®Œå–„ Kconfig

---

## è°ƒè¯•å»ºè®®

### é‡åˆ°ç¼–è¯‘é”™è¯¯
1. æ£€æŸ¥ SConstruct ä¸­çš„ Export/Import
2. æ‰“å°è°ƒè¯•ä¿¡æ¯: `print("Debug:", xxx)`
3. ä½¿ç”¨ `scons -n` æŸ¥çœ‹å‘½ä»¤

### é‡åˆ°é“¾æ¥é”™è¯¯
1. æ£€æŸ¥ LIBS è®¾ç½®
2. æ£€æŸ¥ raylib æ˜¯å¦æ­£ç¡®é“¾æ¥
3. ä½¿ç”¨ `ldd output/bin/CirAni` æŸ¥çœ‹ä¾èµ–

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**åˆ›å»ºæ—¥æœŸ**: 2025-10-16
**ç»´æŠ¤è€…**: CirAni Team
